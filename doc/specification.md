# 在庫管理ツール システム仕様書

## 1. システム概要

### 1.1 目的
ECサイト運営における在庫管理、売上管理、利益計算、価格変動通知を効率化するためのGoogleスプレッドシートベースの管理システム

### 1.2 対象ユーザー
- ECサイト運営者
- 複数スタッフでの利用を想定

### 1.3 技術スタック
- **基盤**: Googleスプレッドシート
- **自動化**: Google Apps Script (GAS)
- **データ取得**: スクレイピング（ルールベース）
- **将来拡張**: Amazon SP-API対応予定

## 2. 機能要件

### 2.1 在庫管理機能

#### 2.1.1 仕入れ元管理
- **機能**: 仕入れ先サイトのURL登録・管理
- **対象サイト**:
  - メルカリ
  - ヤフーフリマ
  - ヤフオク
  - 楽天
  - Yahooショッピング
  - Amazon
  - 個人ショップ（手動追加可能）
- **実装方法**: マスターテーブルによる管理

#### 2.1.2 在庫判定機能
- **判定方法**: 仕入れ先サイトの特定文字列検出
  - 購入可能: 「購入手続きへ」「カートに入れる」等
  - 売り切れ: 「売り切れ」「SOLD OUT」等
- **判定ルール**: シート上で管理、後から追加・変更可能
- **Amazon対応**: ASINコードによる在庫確認
- **制約**: サイト仕様変更による判定精度の変動リスク

#### 2.1.3 価格・利益管理
- **仕入れ価格**: 各サイトからの価格取得
- **販売価格**: 手動設定
- **為替計算**: GOOGLEFINANCE関数によるドル円換算
- **利益計算**: 自動計算（販売価格 - 仕入れ価格 - 手数料）

### 2.2 売上管理機能（Joom注文連携対応）

#### 2.2.1 注文データ管理
- **データ入力**: Joom注文データの自動取得・登録
- **データ変換**: Joom API形式から売上管理シート形式への変換
- **紐付け**: 商品ID（Joom製品SKU）による在庫管理表との連携
- **在庫減算**: 売上発生時の自動在庫数更新
- **重複防止**: Joom注文IDによる重複チェック

#### 2.2.2 注文ステータス管理
- **ステータス追跡**: 注文の状態変化の追跡
- **配送管理**: 出荷・配送状況の管理
- **返品管理**: 返品・返金の管理

#### 2.2.3 顧客情報管理
- **顧客データ**: 注文者の基本情報管理
- **配送先管理**: 配送先住所の管理
- **連絡先管理**: 顧客の連絡先情報管理

#### 2.2.4 利益計算（拡張版）
- **手数料計算**: Joom手数料の自動計算
- **税計算**: VAT（付加価値税）の計算
- **返金処理**: 返金による利益調整
- **純利益**: 全コスト要素を考慮した利益算出

### 2.3 CSV出力機能

#### 2.3.1 Joom形式CSV出力
- **出力対象**: 在庫管理表の商品データ
- **出力方法**: GASによるボタン操作での自動生成
- **形式**: Joomアップロード用CSVフォーマット
- **連携管理**: 未連携商品の識別と連携ステータス管理

#### 2.3.2 未連携商品管理
- **連携ステータス**: 未連携 / 連携済みの2段階管理
- **出力対象選択**: 全商品 / 未連携商品のみ / 選択商品
- **フィルタ機能**: 在庫あり、価格範囲等の条件指定
- **バリデーション**: 必須項目の入力チェックとエラーレポート

#### 2.3.3 データマッピング
- **必須フィールド**: SKU、商品名、商品説明、メイン画像URL、ストアID、重量、価格、通貨、在庫数量、配送価格
- **推奨フィールド**: ブランド、検索タグ、危険物種類、カテゴリID
- **自動変換**: 重量（g→kg）、価格（円→指定通貨）

### 2.4 価格変動通知機能

#### 2.4.1 視覚的通知
- **実装方法**: 条件付き書式によるセル色分け
- **対象**: 仕入れ価格、販売価格の変動
- **データ保持**: 前回価格の補助セル・シート

#### 2.4.2 メール通知
- **実装方法**: GASトリガー機能
- **実行頻度**: 定期実行（例：1日1回）
- **通知内容**: 商品名、変更前後の価格

### 2.5 Joom注文連携機能

#### 2.5.1 認証管理
- **OAuth 2.0認証**: Joom API認証フロー
- **トークン管理**: アクセストークンの自動更新
- **認証状態確認**: 認証の有効性チェック

#### 2.5.2 注文データ取得
- **単一注文取得**: 指定注文IDの詳細取得
- **複数注文取得**: 一括注文データ取得
- **未履行注文取得**: 履行待ち注文のみ取得
- **定期取得**: スケジュール実行による自動取得

#### 2.5.3 データ変換・統合
- **形式変換**: Joom API形式から内部形式への変換
- **データ検証**: 必須フィールドの存在チェック
- **エラーハンドリング**: 変換エラーの適切な処理
- **ログ管理**: 処理ログの記録・管理

#### 2.5.4 同期管理
- **重複チェック**: 既存データとの重複防止
- **差分更新**: 変更されたデータのみ更新
- **エラー通知**: 同期エラーの通知機能
- **復旧機能**: エラー時のデータ復旧

## 3. 非機能要件

### 3.1 パフォーマンス
- **データ量**: 商品点数・月間注文データの想定量に応じた最適化
- **応答性**: スプレッドシートの動作速度維持

### 3.2 可用性
- **同時利用**: 複数ユーザーでの同時編集対応
- **データ整合性**: 同時編集時の競合回避

### 3.3 拡張性
- **API連携**: Amazon SP-API対応時の移行容易性
- **サイト追加**: 新規仕入れ先サイトの柔軟な追加

## 4. データ構造設計

### 4.1 シート構成

#### 4.1.1 在庫管理シート

**基本商品情報フィールド（1-20列）**
| 項目 | データ型 | 説明 | 列 |
|------|----------|------|-----|
| 商品ID | 文字列 | 商品識別子 | A |
| 商品名 | 文字列 | 商品名称 | B |
| SKU | 文字列 | 商品管理コード | C |
| ASIN | 文字列 | Amazon商品コード | D |
| 仕入れ元 | 文字列 | 仕入れ先サイト名 | E |
| 仕入れ元URL | 文字列 | 商品ページURL | F |
| 仕入れ価格 | 数値 | 仕入れ価格（円） | G |
| 販売価格 | 数値 | 販売価格（円） | H |
| 重量 | 数値 | 商品重量（g） | I |
| 商品説明 | 文字列 | Joom用商品説明文 | J |
| メイン画像URL | 文字列 | Joom用メイン画像URL | K |
| 通貨 | 文字列 | 価格の通貨単位（デフォルト：JPY） | L |
| 配送価格 | 数値 | 配送価格（円） | M |
| 在庫数量 | 数値 | 在庫数量（個数） | N |
| 在庫ステータス | 文字列 | 在庫あり/売り切れ（仕入元サイトの在庫状況） | O |
| 利益 | 数値 | 自動計算値 | P |
| 最終更新日時 | 日時 | データ更新日時 | Q |
| 備考・メモ | 文字列 | 備考・メモ | R |
| Joom連携ステータス | 文字列 | 未連携/連携済み | S |
| 最終出力日時 | 日時 | Joom CSV最終出力日時 | T |

#### 4.1.2 売上管理シート（Joom注文連携対応版）

**基本情報フィールド（1-12列）**
| 項目 | データ型 | 説明 | 列 |
|------|----------|------|-----|
| 注文ID | 文字列 | Joom注文ID（8文字英数字） | A |
| 注文日 | 日付 | 注文受付日 | B |
| 商品ID | 文字列 | Joom製品SKU（在庫管理の商品IDと同一） | C |
| 商品名 | 文字列 | 商品名称（在庫管理から取得） | D |
| SKU | 文字列 | 商品管理コード（在庫管理から取得） | E |
| ASIN | 文字列 | Amazon商品コード（在庫管理から取得） | F |
| 数量 | 数値 | 注文数量 | G |
| 販売価格 | 数値 | 実際の販売価格（円） | H |
| 仕入れ価格 | 数値 | 仕入れ価格（円、在庫管理から取得） | I |
| 送料 | 数値 | 配送料（円） | J |
| 純利益 | 数値 | 手数料差し引き後利益（自動計算） | K |
| 登録日時 | 日時 | データ登録日時 | L |

**注文ステータス管理フィールド（13-15列）**
| 項目 | データ型 | 説明 | 列 |
|------|----------|------|-----|
| 注文ステータス | 文字列 | Joom注文ステータス（approved/shipped等） | M |
| Joom連携ステータス | 文字列 | 連携状況（synced/error等） | N |
| 最終同期日時 | 日時 | 最後に同期した日時 | O |

**価格詳細管理フィールド（16-19列）**
| 項目 | データ型 | 説明 | 列 |
|------|----------|------|-----|
| 手数料 | 数値 | Joom手数料（円） | P |
| 付加価値税 | 数値 | VAT金額（円） | Q |
| 返金額 | 数値 | 返金された金額（円） | R |
| 購入者GMV | 数値 | 購入者の総商品価値（円） | S |

**顧客情報フィールド（20-24列）**
| 項目 | データ型 | 説明 | 列 |
|------|----------|------|-----|
| 顧客名 | 文字列 | 注文者の氏名 | T |
| 顧客メール | 文字列 | 注文者のメールアドレス | U |
| 顧客電話番号 | 文字列 | 注文者の電話番号 | V |
| 顧客国コード | 文字列 | 顧客の国コード | W |
| 顧客都道府県 | 文字列 | 顧客の都道府県 | X |

**配送情報フィールド（25-30列）**
| 項目 | データ型 | 説明 | 列 |
|------|----------|------|-----|
| 配送国 | 文字列 | 配送先の国コード | Y |
| 配送都道府県 | 文字列 | 配送先の都道府県 | Z |
| 配送市区町村 | 文字列 | 配送先の市区町村 | AA |
| 配送住所 | 文字列 | 配送先の住所 | AB |
| 配送郵便番号 | 文字列 | 配送先の郵便番号 | AC |
| 配送先住所（完全版） | 文字列 | 配送先住所の完全版文字列 | AD |

**出荷・配送管理フィールド（31-35列）**
| 項目 | データ型 | 説明 | 列 |
|------|----------|------|-----|
| 追跡番号 | 文字列 | 配送追跡番号 | AE |
| 配送業者 | 文字列 | 配送を担当する業者 | AF |
| 出荷日時 | 日時 | 実際の出荷日時 | AG |
| 履行日時 | 日時 | 注文履行完了日時 | AH |
| 配送ステータス | 文字列 | 配送の現在状況 | AI |

**連携管理フィールド（36-37列）**
| 項目 | データ型 | 説明 | 列 |
|------|----------|------|-----|
| 同期エラーメッセージ | 文字列 | 同期時のエラーメッセージ | AJ |
| データソース | 文字列 | データの取得元（Joom/Manual） | AK |

#### 4.1.3 仕入れ元マスターシート
| 項目 | データ型 | 説明 |
|------|----------|------|
| サイト名 | 文字列 | 仕入れ先サイト名 |
| サイトURL | 文字列 | ベースURL |
| 在庫あり判定文字列 | 文字列 | 在庫あり時の検出文字列 |
| 売り切れ判定文字列 | 文字列 | 売り切れ時の検出文字列 |
| 価格取得セレクタ | 文字列 | 価格表示要素のセレクタ |

#### 4.1.4 価格履歴シート
| 項目 | データ型 | 説明 |
|------|----------|------|
| 商品ID | 文字列 | 商品識別子（在庫管理シートの商品IDと連携） |
| チェック日時 | 日時 | 価格チェック実行日時 |
| 仕入れ価格 | 数値 | チェック時点の仕入れ価格 |
| 販売価格 | 数値 | チェック時点の販売価格 |
| 変動フラグ | 文字列 | 価格変動の有無 |

#### 4.1.5 設定シート（Joom注文連携設定統合版）

**基本設定フィールド**
| 項目 | データ型 | 説明 |
|------|----------|------|
| ストアID | 文字列 | JoomのストアID（全商品共通） |
| デフォルト通貨 | 文字列 | デフォルトの通貨設定 |
| デフォルト配送価格 | 数値 | デフォルトの配送価格（円） |
| カテゴリID | 文字列 | JoomカテゴリID（必要に応じて設定） |
| 検索タグ | 文字列 | 商品検索用タグ（カンマ区切り） |
| 危険物種類 | 文字列 | 配送時の危険物種類 |
| 価格変動通知メールアドレス | 文字列 | 価格変動時の通知先メールアドレス |
| 価格変動通知有効化 | 真偽値 | 価格変動通知機能の有効/無効 |

**Joom注文連携認証情報フィールド**
| 項目 | データ型 | 説明 |
|------|----------|------|
| Joom Client ID | 文字列 | Joom API Client ID |
| Joom Client Secret | 文字列 | Joom API Client Secret |
| Joom Access Token | 文字列 | 現在のアクセストークン |
| Joom Refresh Token | 文字列 | リフレッシュトークン |
| Joom Token Expiry | 日時 | トークンの有効期限 |

**Joom注文連携API設定フィールド**
| 項目 | データ型 | 説明 |
|------|----------|------|
| Joom API Base URL | 文字列 | Joom API ベースURL |
| Joom サンドボックス使用 | 真偽値 | サンドボックス環境の使用フラグ |
| Joom 取得間隔（分） | 数値 | 注文データ取得間隔 |
| Joom 最大取得件数 | 数値 | 1回の取得で処理する最大件数 |

**Joom注文連携通知設定フィールド**
| 項目 | データ型 | 説明 |
|------|----------|------|
| Joom エラー通知メール | 文字列 | エラー通知先メールアドレス |
| Joom 同期完了通知 | 真偽値 | 同期完了時の通知フラグ |
| Joom エラー通知 | 真偽値 | エラー発生時の通知フラグ |

## 5. 技術的制約・リスク

### 5.1 スクレイピング制約
- **Amazon**: 規約によりスクレイピング制限、アクセスブロックリスク
- **サイト仕様変更**: 判定ルールの変更による機能停止リスク
- **アクセス頻度**: 過度なアクセスによるIP制限リスク

### 5.2 GAS制約
- **実行時間制限**: 6分/実行の制限
- **API呼び出し制限**: 1日あたりの制限
- **メール送信制限**: 1日あたりの送信数制限

### 5.3 スプレッドシート制約
- **セル数制限**: 500万セル
- **同時編集**: 複数ユーザー同時編集時の競合
- **計算負荷**: 大量データ処理時の動作速度低下

### 5.4 Joom API制約
- **レート制限**: 2000 rpm（1分あたりのリクエスト数）
- **認証期限**: アクセストークンの有効期限管理
- **データ形式**: JSON形式でのデータ送受信
- **エラーハンドリング**: API エラーレスポンスの適切な処理
- **サンドボックス**: テスト環境での動作確認

### 5.5 データ整合性リスク
- **重複データ**: 同一注文の重複取り込みリスク
- **データ不整合**: 在庫管理と売上管理の整合性
- **同期エラー**: API接続エラーによるデータ欠損
- **トランザクション**: 複数シート更新時の整合性確保

## 6. 運用要件

### 6.1 ユーザー権限
- **管理者**: 全機能利用可能
- **一般ユーザー**: データ閲覧・一部編集権限

### 6.2 バックアップ
- **自動バックアップ**: Googleドライブの自動保存機能
- **手動バックアップ**: 定期的なエクスポート

### 6.3 マニュアル
- **操作マニュアル**: スタッフ向け操作手順書
- **トラブルシューティング**: よくある問題と解決方法

### 6.4 ユーザーインターフェース

#### 6.4.1 カスタムメニュー構成
Googleスプレッドシートのカスタムメニューによる操作インターフェースを提供します。

```
📊 EC管理システム
├── 📦 商品管理
│   ├── 新商品追加
│   └── 商品削除
├── 📈 売上管理
│   ├── 注文データ入力
│   ├── Joom注文同期
│   └── 注文ステータス管理
├── 🔄 在庫チェック
│   ├── 全商品在庫チェック
│   ├── 選択商品チェック
│   └── 定期チェック設定
├── 📤 データ出力
│   └── Joom用CSV出力
├── 🛠️ システム管理
│   ├── 全シート初期化
│   └── データバックアップ
└── ⚙️ システム設定
    ├── 通知設定
    └── Joom連携設定
```

#### 6.4.2 メニュー機能詳細

**📦 商品管理**
- **新商品追加**: 入力ウィンドウによる商品情報入力
- **商品削除**: 選択した商品の削除機能

**📈 売上管理**
- **注文データ入力**: 入力ウィンドウによるJoom注文データの入力
- **Joom注文同期**: Joom APIからの注文データ自動取得
- **注文ステータス管理**: 注文の状態追跡・管理

**🔄 在庫チェック**
- **全商品在庫チェック**: 全商品の一括在庫確認
- **選択商品チェック**: 選択した商品のみの在庫確認
- **定期チェック設定**: 自動在庫チェックのスケジュール設定

**📤 データ出力**
- **Joom用CSV出力**: 在庫データからJoom形式CSVの生成・ダウンロード
  - 未連携商品のみ出力
  - 全商品出力
  - 選択商品出力
  - 出力設定
- **連携ステータス更新**: Joom連携ステータスの一括更新

**🛠️ システム管理**
- **全シート初期化**: 全シートの初期化・再構築機能
  - 在庫管理シートの初期化
  - 売上管理シートの初期化（Joom注文連携対応版）
  - 設定シートの初期化（Joom注文連携設定統合版）
  - 仕入れ元マスターシートの初期化
  - 価格履歴シートの初期化
- **データバックアップ**: データのバックアップ・復元機能

**⚙️ システム設定**
- **通知設定**: 価格変動通知の設定（メールアドレス、通知条件等）
- **Joom連携設定**: Joom API認証情報・同期設定

#### 6.4.3 入力インターフェース
- **入力ウィンドウ（Phase 1）**: 基本的な入力機能
  - シンプルなpromptによる入力
  - 迅速な実装とデバッグ
  - 基本的なバリデーション機能
- **HTMLフォーム（Phase 2以降）**: 高度な入力機能
  - カスタムHTMLフォームによる入力
  - 高度なバリデーション機能
  - エラーハンドリング機能

#### 6.4.4 権限管理
- **管理者**: 全機能利用可能
- **一般ユーザー**: データ閲覧・一部編集権限

## 7. 将来拡張計画

### 7.1 短期拡張（3-6ヶ月）
- **Joom注文連携**: Joom API連携機能の完全実装
- **API連携**: Amazon SP-API導入
- **通知機能強化**: Slack連携、LINE通知
- **レポート機能**: 売上分析、利益分析

### 7.2 中期拡張（6-12ヶ月）
- **Python移行**: サーバーサイド処理の強化
- **データベース連携**: 外部DBとの連携
- **AI機能**: 価格予測、在庫最適化

### 7.3 長期拡張（1年以上）
- **Webアプリ化**: 独立したWebアプリケーション
- **マルチプラットフォーム**: 複数ECサイト対応強化
- **自動化強化**: 完全自動在庫管理

## 8. 段階的実装計画

### Phase 1: 基盤構築（2-3週間）
**目標**: スクレイピングに依存しない安定した機能の実装

#### 1.1 データ構造の確定
- **在庫管理シート**の設計・作成
  - 商品情報、価格、在庫数の管理
  - 利益計算式の実装
  - 為替レート取得機能（GOOGLEFINANCE関数）
  - Joom連携管理フィールドの追加
- **売上管理シート**の設計・作成（Joom注文連携対応）
  - 注文データの入力フォーム
  - 商品ID（Joom製品SKU）による在庫管理シートとの紐付け
  - 手数料計算・純利益算出
  - 顧客・配送・出荷管理フィールドの追加
- **設定シート**の設計・作成（Joom注文連携設定統合版）
  - 基本設定管理
  - Joom注文連携認証情報管理
  - Joom注文連携API設定管理
  - Joom注文連携通知設定管理
- **ルール管理シート**の設計・作成
  - 仕入れ元サイトのマスターデータ
  - 在庫判定ルールの管理
  - 手数料率の管理

#### 1.2 基本機能の実装
- **全シート初期化機能**
  - 在庫管理シートの初期化
    - 基本商品情報フィールド（1-20列）の設定
    - ヘッダー行の書式設定と列幅調整
    - 条件付き書式による視覚的表示設定
  - 売上管理シートの初期化（Joom注文連携対応版）
    - 基本情報フィールド（1-12列）の設定
    - 注文ステータス管理フィールド（13-15列）の設定
    - 価格詳細管理フィールド（16-19列）の設定
    - 顧客情報フィールド（20-24列）の設定
    - 配送情報フィールド（25-30列）の設定
    - 出荷・配送管理フィールド（31-35列）の設定
    - 連携管理フィールド（36-37列）の設定
    - ヘッダー行の書式設定と列幅調整
    - 利益計算式の自動設定
  - 設定シートの初期化（Joom注文連携設定統合版）
    - 基本設定フィールドの設定
    - Joom注文連携認証情報フィールドの設定
    - Joom注文連携API設定フィールドの設定
    - Joom注文連携通知設定フィールドの設定
    - デフォルト値の設定
  - 仕入れ元マスターシートの初期化
  - 価格履歴シートの初期化
- **利益計算機能**
  - 仕入れ価格、販売価格、手数料を考慮した自動計算
  - 為替レート適用（ドル円換算）
- **Joom用CSV出力機能**
  - 在庫管理データからJoom形式CSVの自動生成
  - 未連携商品の識別とフィルタリング
  - 必須項目のバリデーション機能
  - ダウンロード機能の実装
- **Joom注文連携機能**
  - OAuth 2.0認証フローの実装
  - 注文データ取得機能
  - データ変換・統合機能
  - 重複チェック・同期管理機能
- **データ入力・編集機能**
  - 商品情報の手動入力・編集
  - 売上データの入力・管理

#### 1.3 基本UIの構築
- **カスタムメニューの実装**
  - EC管理システムメニューの作成
  - 各機能へのアクセス方法の確立
- **入力インターフェースの作成**
  - 新商品追加用入力ウィンドウ
  - 注文データ入力用入力ウィンドウ
  - 設定用入力ウィンドウ（Joom注文連携設定統合版）
  - 各種設定用入力ウィンドウ
- **条件付き書式による視覚的表示**
  - 在庫ステータスによる色分け
  - 価格変動のハイライト表示

### Phase 2: スクレイピング実装（4-5週間）
**目標**: 段階的なスクレイピング機能の実装

#### 2.1 優先サイトの選定・実装（2週間）
**対象サイト候補**:
- **ヤフオク**: 構造が比較的単純、API制限が緩い
- **メルカリ**: 個人売買サイト、情報取得が容易
- **楽天市場**: 大手ECサイト、構造が安定

**実装内容**:
- 各サイトの商品ページ構造解析
- 在庫判定ロジックの実装
- 価格取得機能の実装
- エラーハンドリングの実装

#### 2.2 大手サイトへの対応（2-3週間）
**Amazon対応**:
- ASINコードによる商品識別
- 在庫確認機能（規約遵守）
- 価格取得機能
- アクセス制限への対応

**その他大手サイト**:
- Yahooショッピング
- その他指定サイト

#### 2.3 スクレイピング機能の統合
- 一括在庫チェック機能
- 定期実行機能（GASトリガー）
- エラー通知機能

### Phase 3: 通知・拡張機能（2-3週間）
**目標**: 価格変動通知と運用支援機能の実装

#### 3.1 価格変動通知機能
- **視覚的通知**: 条件付き書式による色分け
- **メール通知**: GASによる自動メール送信
- **価格履歴管理**: 変動履歴の記録・表示

#### 3.2 運用支援機能
- **ダッシュボード**: 売上・利益の可視化
- **レポート機能**: 月次・週次の売上分析
- **バックアップ機能**: データの自動バックアップ

### Phase 4: テスト・最適化（1-2週間）
**目標**: システムの安定性確保とパフォーマンス最適化

#### 4.1 総合テスト
- 全機能の動作確認
- エラーケースのテスト
- 複数ユーザーでの同時利用テスト

#### 4.2 パフォーマンス調整
- 大量データ処理の最適化
- GAS実行時間の最適化
- メモリ使用量の調整

### Phase 5: マニュアル作成・納品（1週間）
**目標**: 運用開始に向けたドキュメント整備

#### 5.1 操作マニュアル作成
- **基本操作マニュアル**: 日常的な操作方法
  - カスタムメニューの使い方
  - 新商品追加の手順
  - 在庫チェックの実行方法
  - CSV出力の手順
- **管理者マニュアル**: 設定変更・メンテナンス方法
  - 通知設定の変更
  - 定期チェック設定の管理
  - システム設定の変更
- **トラブルシューティング**: よくある問題と解決方法

#### 5.2 技術ドキュメント
- **システム構成書**: シート構成・GAS機能の説明
- **カスタマイズガイド**: 新規サイト追加方法
- **API連携準備**: 将来のSP-API対応に向けた設計書

#### 5.3 納品・引き渡し
- システムの最終確認
- クライアントへの操作方法説明
- サポート体制の確立

## 9. 実装における重要ポイント

### 9.1 Phase 1（基盤構築）の成功要因
- **データ構造の最適化**: 将来の拡張性を考慮した設計
- **利益計算の精度**: 全てのコスト要素を考慮した計算式
- **ユーザビリティ**: 直感的な操作インターフェース
- **エラーハンドリング**: データ入力時のバリデーション機能

### 9.2 Phase 2（スクレイピング）のリスク管理
- **段階的実装**: 簡単なサイトから順次対応
- **フォールバック機能**: スクレイピング失敗時の手動入力対応
- **アクセス制限対策**: 適切な間隔でのアクセス制御
- **サイト変更対応**: 構造変更時の迅速な対応体制

### 9.3 技術的考慮事項
- **GAS制限への対応**: 実行時間・API呼び出し制限の最適化
- **データ整合性**: 同時編集時の競合回避
- **パフォーマンス**: 大量データ処理時の最適化
- **セキュリティ**: 機密データの適切な管理

## 10. 確認事項

### 10.1 データ移行
- 既存在庫データの移行方法
- 移行データの形式・量
- データクレンジングの必要性

### 10.2 計算式詳細
- 利益計算の詳細式（送料、税金、ポイント等）
- 各ECサイトの手数料体系
- 為替レート適用タイミング

### 10.3 運用要件
- 想定商品点数・月間注文数
- 同時利用ユーザー数
- 通知メールの宛先・内容
- バックアップ・復旧要件

### 10.4 フォーマット
- Joom CSVアップロードフォーマット
  - 必須フィールド：Product SKU、Name、Description、Product Main Image URL、Store ID、Shipping Weight、Price、Currency、Inventory、Shipping Price
  - 推奨フィールド：Brand、Search Tags、Dangerous Kind、Suggested Category ID
  - データ変換：重量（g→kg）、価格（円→指定通貨）
- その他ECサイトのCSVフォーマット
- データエクスポート形式

### 10.5 優先実装サイト
- Phase 2で優先的に実装するサイトの選定
- 各サイトのアクセス頻度・重要度
- サイト固有の制約事項

---

**作成日**: 2025年9月
**バージョン**: 1.0
**作成者**: システム仕様書作成
