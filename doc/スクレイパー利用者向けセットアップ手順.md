# スクレイパー利用者向けセットアップ手順

## はじめに

このドキュメントは、**Pythonがインストールされていない端末**でスクレイピング機能を利用するためのセットアップ手順です。

## 必要な環境

- **Windows 10以上**
- **Google Chrome**（インストール済み）
- **インターネット接続**
- **Googleアカウント**（スプレッドシートへのアクセス権限が必要）

## セットアップ手順

### ステップ1: ファイルの配置

1. 配布された`InventoryScraper_Package`フォルダを任意の場所に展開します
   - 推奨: `C:\Program Files\InventoryScraper\` または `C:\Users\[ユーザー名]\InventoryScraper\`

2. フォルダ内に以下のファイルが含まれていることを確認します
   ```
   InventoryScraper_Package/
   ├── InventoryScraper.exe
   ├── config/
   │   └── scraper_config.json
   └── .env.example
   ```

### ステップ2: 環境設定ファイル（.env）の作成

1. フォルダ内に`.env`ファイルを作成します
   - メモ帳で新規ファイルを作成
   - ファイル名を`.env`として保存（拡張子なし）
   - **重要**: ファイル名の先頭にドット（.）を付ける

2. `.env`ファイルに以下の内容を記述します

```ini
# スプレッドシート情報
SPREADSHEET_ID=ここにスプレッドシートIDを入力
SHEET_GID=0

# Google Apps Script WebアプリURL（必須）
GAS_WEB_APP_URL=ここにGAS WebアプリURLを入力

# ローカルChrome設定
CHROME_PROFILE_PATH=C:\Users\[ユーザー名]\AppData\Local\Google\Chrome\User Data
CHROME_PROFILE_NAME=Default

# ダウンロードフォルダ
DOWNLOAD_FOLDER=C:\Users\[ユーザー名]\Downloads

# ログ設定
LOG_LEVEL=INFO
```

#### 設定値の取得方法

##### スプレッドシートID（SPREADSHEET_ID）

1. Googleスプレッドシートを開く
2. URLを確認
   - 例: `https://docs.google.com/spreadsheets/d/1ABC123xyz789/edit`
   - `/d/`と`/edit`の間の文字列（`1ABC123xyz789`）がスプレッドシートID

##### GAS WebアプリURL（GAS_WEB_APP_URL）

- 開発者から提供されるURLを使用してください
- 例: `https://script.google.com/macros/s/AKfycbz1234567890abcdef/exec`

##### Chromeプロファイルパス（CHROME_PROFILE_PATH）

1. エクスプローラーを開く
2. アドレスバーに以下を入力してEnter
   ```
   %LOCALAPPDATA%\Google\Chrome\User Data
   ```
3. 表示されたパスを`.env`に設定
   - 例: `C:\Users\山田太郎\AppData\Local\Google\Chrome\User Data`

##### ダウンロードフォルダ（DOWNLOAD_FOLDER）

- 通常は`C:\Users\[ユーザー名]\Downloads`で問題ありません
- カスタムのダウンロードフォルダを使用している場合は、そのパスを指定

### ステップ3: Google Chromeの確認

1. **Google Chromeを起動**して、Googleアカウントにログインしていることを確認
   - スプレッドシートにアクセスできるアカウントでログインしてください

2. **Chromeのバージョンを最新に更新**（推奨）
   - Chromeのメニュー（三点リーダー）→「ヘルプ」→「Google Chromeについて」

### ステップ4: 初回実行

1. **`InventoryScraper.exe`をダブルクリック**して実行

2. **セキュリティ警告が表示された場合**
   - 「詳細情報」をクリック
   - 「実行」をクリックして実行を許可

3. **初回実行時の注意**
   - ChromeDriverが自動的にダウンロードされるため、数分かかる場合があります
   - コンソールウィンドウが表示され、処理の進行状況が表示されます

### ステップ5: ショートカットの作成（オプション）

デスクトップにショートカットを作成すると便利です。

1. `InventoryScraper.exe`を右クリック
2. 「ショートカットの作成」を選択
3. 作成されたショートカットをデスクトップに移動

## 使用方法

1. `InventoryScraper.exe`をダブルクリック
2. コンソールウィンドウが表示され、処理が開始されます
3. 処理が完了すると、スプレッドシートが自動的に更新されます

## トラブルシューティング

### exeファイルが起動しない

**対処法:**
- セキュリティソフトの設定で、`InventoryScraper.exe`を例外に追加
- Visual C++ Redistributableをインストール
  - [ダウンロードリンク](https://aka.ms/vs/17/release/vc_redist.x64.exe)

### スプレッドシートにアクセスできない

**確認事項:**
1. `.env`ファイルの`SPREADSHEET_ID`が正しいか
2. Chromeでスプレッドシートにアクセスできるか
3. Chromeプロファイルパスが正しいか
4. Googleアカウントにログインしているか

### GAS Webアプリへの接続エラー

**確認事項:**
1. `.env`ファイルに`GAS_WEB_APP_URL`が正しく設定されているか
2. GAS Webアプリが正しくデプロイされているか

### 設定ファイルが見つからない

**確認事項:**
1. `config`フォルダがexeファイルと同じディレクトリに存在するか
2. `config/scraper_config.json`ファイルが存在するか

## ログファイルの確認

実行ログは`logs`フォルダに保存されます（自動的に作成されます）。

エラーが発生した場合は、`logs`フォルダ内の最新のログファイルを確認してください。

## サポート

問題が解決しない場合は、以下の情報を含めて開発者に連絡してください。

1. エラーメッセージの全文
2. `logs`フォルダ内の最新のログファイル
3. `.env`ファイルの内容（機密情報はマスクして）
4. Windowsのバージョン、Chromeのバージョン

---

**作成日**: 2026-01-21  
**最終更新**: 2026-01-21
