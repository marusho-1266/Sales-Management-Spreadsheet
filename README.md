# 在庫管理ツール システム

## 概要
ECサイト運営における在庫管理、売上管理、利益計算、価格変動通知を効率化するためのGoogleスプレッドシートベースの管理システムです。

## 技術スタック
- **基盤**: Googleスプレッドシート
- **自動化**: Google Apps Script (GAS)
- **データ取得**: スクレイピング（ルールベース）

## シート構成

### 1. 在庫管理シート
商品の基本情報、価格、在庫数を管理するメインシートです。

**主要項目:**
- 商品ID、商品名、SKU、ASIN
- 仕入れ元、仕入れ元URL
- 仕入れ価格、販売価格、在庫数
- 在庫ステータス、利益（自動計算）

### 2. 売上管理シート
注文データと売上情報を管理するシートです。

**主要項目:**
- 注文ID、注文日、商品ID
- 数量、販売価格、送料、手数料
- 純利益（自動計算）

### 3. 仕入れ元マスターシート
仕入れ先サイトの情報とスクレイピングルールを管理するシートです。

**主要項目:**
- サイト名、サイトURL
- 在庫判定文字列、価格取得セレクタ
- 手数料率、アクセス間隔

### 4. 価格履歴シート
価格変動の履歴を記録・管理するシートです。

**主要項目:**
- 商品ID、チェック日時
- 仕入れ価格、販売価格
- 価格変動フラグ、変動率

## セットアップ手順

### 1. Googleスプレッドシートの作成
1. 新しいGoogleスプレッドシートを作成
2. スプレッドシートの名前を「在庫管理ツール」に変更

### 2. Google Apps Scriptの設定
1. スプレッドシートで「拡張機能」→「Apps Script」を選択
2. 既存のコードを削除
3. 各ファイル（.gs）の内容をコピー&ペースト
4. 保存（Ctrl+S）

### 3. シートの初期化
1. Apps Scriptエディタで「initializeAllSheets」関数を実行
2. または、スプレッドシートに戻って「📊 EC管理システム」→「🔄 全シート初期化」を選択

## 使用方法

### カスタムメニュー
スプレッドシートに「📊 EC管理システム」メニューが追加されます。

**利用可能な機能:**
- 📦 商品管理
- 📈 売上管理
- 🔄 在庫チェック
- 📤 データ出力
- ⚙️ システム設定

### 基本操作
1. **商品追加**: 在庫管理シートに直接入力
2. **売上登録**: 売上管理シートに注文データを入力
3. **在庫確認**: 在庫管理シートで在庫ステータスを確認
4. **価格履歴**: 価格履歴シートで価格変動を確認

## 機能詳細

### 条件付き書式
- **在庫ステータス**: 在庫あり（緑）、売り切れ（赤）
- **在庫数**: 1以下（黄）、0（赤）
- **利益**: 高利益（緑）、低利益（黄）、損失（赤）
- **価格変動**: 上昇（赤）、下落（緑）

### 自動計算
- **利益計算**: 販売価格 - 仕入れ価格 - 手数料
- **純利益計算**: 販売価格 - 仕入れ価格 - 手数料
- **変動率計算**: 価格変動の割合を自動計算

## 今後の実装予定

### Phase 1: 基盤構築（完了）
- ✅ データ構造の確定
- ✅ 基本機能の実装
- ✅ 基本UIの構築

### Phase 2: スクレイピング実装（予定）
- 在庫チェック機能
- 価格取得機能
- 定期実行機能

### Phase 3: 通知・拡張機能（予定）
- 価格変動通知
- メール通知
- レポート機能

## 注意事項

### 制限事項
- GAS実行時間制限: 6分/実行
- スプレッドシートセル数制限: 500万セル
- 同時編集時の競合に注意

### セキュリティ
- 機密データの適切な管理
- アクセス権限の適切な設定
- 定期的なバックアップの実施

## サポート

問題が発生した場合は、以下を確認してください：
1. スプレッドシートの権限設定
2. Apps Scriptの実行権限
3. インターネット接続状況

---

**作成日**: 2025-09-27  
**バージョン**: 1.0  
**開発者**: 在庫管理ツール開発チーム
